Copying basically what is on https://www.joshmcguigan.com/blog/build-your-own-shell-rust/

